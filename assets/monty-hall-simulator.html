<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محاكي مسألة مونتي هول</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            direction: rtl;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .game-area {
            text-align: center;
            margin: 40px 0;
        }

        .doors {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .door {
            width: 150px;
            height: 200px;
            background: linear-gradient(145deg, #8B4513, #A0522D);
            border: 6px solid #654321;
            border-radius: 15px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .door:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3);
        }

        .door.selected {
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .door.opened {
            background: #2d3748;
            cursor: default;
        }

        .door.opened:hover {
            transform: none;
        }

        .door-number {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: #333;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1em;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .door-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .door.opened .door-content {
            opacity: 1;
        }

        .door-handle {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: #ffd700;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .game-status {
            margin: 30px 0;
            min-height: 60px;
        }

        .message {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #4a5568;
            font-weight: 500;
            line-height: 1.6;
        }

        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn-stay {
            background: linear-gradient(45deg, #ff6b6b, #ff5252);
            color: white;
        }

        .btn-stay:hover {
            background: linear-gradient(45deg, #ff5252, #ff1744);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .btn-switch {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .btn-switch:hover {
            background: linear-gradient(45deg, #44a08d, #2c8577);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.4);
        }

        .btn-reset {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-reset:hover {
            background: linear-gradient(45deg, #764ba2, #5a67d8);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .stats {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 40px;
            align-items: center;
        }

        .stats-row {
            display: flex;
            gap: 20px;
            justify-content: center;
            width: 100%;
            flex-wrap: wrap;
        }

        .stats-row.single {
            justify-content: center;
        }

        .stat-card {
            background: linear-gradient(145deg, #f7fafc, #edf2f7);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-card h3 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #4299e1;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #718096;
            font-size: 0.9em;
        }

        .win {
            color: #48bb78;
        }

        .lose {
            color: #f56565;
        }

        @media (max-width: 600px) {
            .doors {
                gap: 15px;
            }
            
            .door {
                width: 100px;
                height: 140px;
            }
            
            .door-content {
                font-size: 2.5em;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .container {
                padding: 20px;
            }

            .buttons {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🎰 محاكي مسألة مونتي هول</h1>

        <div class="game-area">
            <div class="doors">
                <div class="door" id="door1" onclick="selectDoor(1)">
                    <div class="door-number">١</div>
                    <div class="door-handle"></div>
                    <div class="door-content"></div>
                </div>
                <div class="door" id="door2" onclick="selectDoor(2)">
                    <div class="door-number">٢</div>
                    <div class="door-handle"></div>
                    <div class="door-content"></div>
                </div>
                <div class="door" id="door3" onclick="selectDoor(3)">
                    <div class="door-number">٣</div>
                    <div class="door-handle"></div>
                    <div class="door-content"></div>
                </div>
            </div>

            <div class="game-status">
                <div class="message" id="message">اضغط على أي باب أعلاه لبدء اللعب! 🎯</div>
                <div class="buttons" id="buttons"></div>
            </div>
        </div>

        <div class="stats">
            <div class="stats-row single">
                <div class="stat-card">
                    <h3>إجمالي المحاولات</h3>
                    <div class="stat-number" id="totalGames">0</div>
                    <div class="stat-label">محاولة</div>
                </div>
            </div>
            
            <div class="stats-row">
                <div class="stat-card">
                    <h3>استراتيجية البقاء</h3>
                    <div class="stat-number" id="stayWins">0</div>
                    <div class="stat-label" id="stayTotal">من 0</div>
                </div>
                <div class="stat-card">
                    <h3>استراتيجية التبديل</h3>
                    <div class="stat-number" id="switchWins">0</div>
                    <div class="stat-label" id="switchTotal">من 0</div>
                </div>
            </div>
            
            <div class="stats-row">
                <div class="stat-card">
                    <h3>عند البقاء</h3>
                    <div class="stat-number" id="stayRate">0%</div>
                    <div class="stat-label">معدل النجاح</div>
                </div>
                <div class="stat-card">
                    <h3>عند التبديل</h3>
                    <div class="stat-number" id="switchRate">0%</div>
                    <div class="stat-label">معدل النجاح</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let gameState = {
            phase: 'select',
            selectedDoor: null,
            carDoor: null,
            revealedDoor: null,
            finalChoice: null,
            gameWon: false
        };

        let stats = {
            totalGames: 0,
            stayWins: 0,
            stayTotal: 0,
            switchWins: 0,
            switchTotal: 0
        };

        // Arabic numerals conversion
        function toArabicNumerals(num) {
            const arabicNumerals = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
            return num.toString().replace(/[0-9]/g, (digit) => arabicNumerals[digit]);
        }

        function initGame() {
            gameState = {
                phase: 'select',
                selectedDoor: null,
                carDoor: Math.floor(Math.random() * 3) + 1,
                revealedDoor: null,
                finalChoice: null,
                gameWon: false
            };

            for (let i = 1; i <= 3; i++) {
                const door = document.getElementById(`door${i}`);
                door.className = 'door';
                door.onclick = () => selectDoor(i);
                door.querySelector('.door-content').innerHTML = '';
                door.style.border = '6px solid #654321';
            }

            document.getElementById('message').textContent = 'اضغط على أي باب أعلاه لبدء اللعب! 🎯';
            document.getElementById('buttons').innerHTML = '';
        }

        function selectDoor(doorNumber) {
            if (gameState.phase !== 'select') return;

            gameState.selectedDoor = doorNumber;
            gameState.phase = 'reveal';

            document.getElementById(`door${doorNumber}`).classList.add('selected');

            revealGoatDoor();
        }

        function revealGoatDoor() {
            // Find doors that are not selected and don't have the car
            let goatDoors = [];
            for (let i = 1; i <= 3; i++) {
                if (i !== gameState.selectedDoor && i !== gameState.carDoor) {
                    goatDoors.push(i);
                }
            }

            // If the selected door has the car, we can reveal either of the other two doors
            if (goatDoors.length === 0) {
                // This means the car is behind the selected door
                // So we can reveal any of the other doors (they both have goats)
                goatDoors = [1, 2, 3].filter(i => i !== gameState.selectedDoor);
            }

            // Randomly choose one of the goat doors to reveal
            gameState.revealedDoor = goatDoors[Math.floor(Math.random() * goatDoors.length)];

            const revealedDoorEl = document.getElementById(`door${gameState.revealedDoor}`);
            revealedDoorEl.classList.add('opened');
            revealedDoorEl.onclick = null;
            revealedDoorEl.querySelector('.door-content').innerHTML = '🐐';

            gameState.phase = 'final';
            showFinalChoice();
        }

        function showFinalChoice() {
            const otherDoor = [1, 2, 3].find(i => i !== gameState.selectedDoor && i !== gameState.revealedDoor);
            
            document.getElementById('message').innerHTML = 
                `المضيف كشف عن ماعز خلف الباب ${toArabicNumerals(gameState.revealedDoor)}! 🐐<br>
                اخترت الباب ${toArabicNumerals(gameState.selectedDoor)}. هل تريد البقاء أم التبديل إلى الباب ${toArabicNumerals(otherDoor)}؟`;

            document.getElementById('buttons').innerHTML = `
                <button class="btn btn-stay" onclick="makeChoice('stay')">البقاء مع الباب ${toArabicNumerals(gameState.selectedDoor)}</button>
                <button class="btn btn-switch" onclick="makeChoice('switch')">التبديل إلى الباب ${toArabicNumerals(otherDoor)}</button>
            `;
        }

        function makeChoice(choice) {
            if (gameState.phase !== 'final') return;

            gameState.phase = 'complete';
            
            if (choice === 'stay') {
                gameState.finalChoice = gameState.selectedDoor;
                stats.stayTotal++;
            } else {
                gameState.finalChoice = [1, 2, 3].find(i => i !== gameState.selectedDoor && i !== gameState.revealedDoor);
                stats.switchTotal++;
            }

            revealAllDoors();

            gameState.gameWon = (gameState.finalChoice === gameState.carDoor);
            
            stats.totalGames++;
            if (gameState.gameWon) {
                if (choice === 'stay') {
                    stats.stayWins++;
                } else {
                    stats.switchWins++;
                }
            }

            updateStats();
            showResult();
        }

        function revealAllDoors() {
            for (let i = 1; i <= 3; i++) {
                const door = document.getElementById(`door${i}`);
                door.classList.add('opened');
                door.onclick = null;
                
                if (i === gameState.carDoor) {
                    door.querySelector('.door-content').innerHTML = '🚗';
                } else if (i !== gameState.revealedDoor) {
                    door.querySelector('.door-content').innerHTML = '🐐';
                }

                if (i === gameState.finalChoice) {
                    door.style.border = '6px solid #ffd700';
                }
            }
        }

        function showResult() {
            const resultClass = gameState.gameWon ? 'win' : 'lose';
            const resultEmoji = gameState.gameWon ? '🎉' : '😢';
            const resultText = gameState.gameWon ? 'فزت بالسيارة!' : 'حصلت على ماعز!';
            
            document.getElementById('message').innerHTML = 
                `<span class="${resultClass}">${resultEmoji} ${resultText}</span><br>
                كانت السيارة خلف الباب ${toArabicNumerals(gameState.carDoor)}.`;

            document.getElementById('buttons').innerHTML = `
                <button class="btn btn-reset" onclick="initGame()">العب مرة أخرى</button>
            `;
        }

        function updateStats() {
            document.getElementById('totalGames').textContent = stats.totalGames;
            document.getElementById('stayWins').textContent = stats.stayWins;
            document.getElementById('stayTotal').textContent = `من ${stats.stayTotal}`;
            document.getElementById('switchWins').textContent = stats.switchWins;
            document.getElementById('switchTotal').textContent = `من ${stats.switchTotal}`;
            
            const stayRate = stats.stayTotal > 0 ? Math.round((stats.stayWins / stats.stayTotal) * 100) : 0;
            const switchRate = stats.switchTotal > 0 ? Math.round((stats.switchWins / stats.switchTotal) * 100) : 0;
            
            document.getElementById('stayRate').textContent = `${stayRate}%`;
            document.getElementById('switchRate').textContent = `${switchRate}%`;
        }

        initGame();
    </script>
</body>
</html>
